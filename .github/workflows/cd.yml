on:
  push:
    tags:
      - release/stage/major
      - release/stage/minor
      - release/stage/patch
      - release/stage/build
      - release/prod/major
      - release/prod/minor
      - release/prod/patch
      - release/prod/build
    
jobs:
  build:
    runs-on: ubuntu-latest

    steps:
     - name: ⬇️ Checkout repo+tags
       uses: actions/checkout@v3
       with:
         fetch-depth: 0
     - name: foo
       run: echo "base_ref= ${{ github.event.base_ref }}"
     - name: 🏷 Parse action tag
       id: parse-action-tag
       run: .github/workflows/scripts/parse-action-tag.sh ${{ github.event.ref }}
     - name: 🔎 Get version
       id: get-version
       run: .github/workflows/scripts/get-version.sh
     - name: ⏩ Bump version
       id: bump-version
       run: .github/workflows/scripts/bump-version.sh ${{ steps.parse-action-tag.outputs.ACTION }} ${{ steps.get-version.outputs.VERSION }}
     - name: ✍️ Update pubsepc version
       run: .github/workflows/scripts/update-pubspec.sh ${{ steps.bump-version.outputs.VERSION }} ${{ github.event.pusher.name }} ${{ github.event.pusher.email }}
     - name: ⬆️ Update repo
       run: .github/workflows/scripts/update-repo.sh ${{ steps.parse-action-tag.outputs.TAG }} ${{ steps.bump-version.outputs.VERSION }} ${{ github.event.pusher.name }} ${{ github.event.pusher.email }}